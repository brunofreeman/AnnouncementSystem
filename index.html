<!DOCTYPE html>
<head>
	<meta content="charset=utf-8" />
	<title>Announcements</title>
	<link rel="icon" href="images\logo.png">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<style>
		* {
			text-align: center;
			font-weight: bold;
			font-family: sans-serif;
		}
		body {
			background-image: url("images\\background.png");
			background-size: 100vw 100vh;
			margin: 0%;
		}
		span {
			position: relative;
		}
		#ribbon {
			position: absolute;
			height: 8vh;
			width: 100vw;
			background-color: #b71c1c;
		}
		#logo {
			height: 8vh;
			display: block;
			margin-left: auto;
			margin-right: auto;
		}
		.card {
			position: absolute;
			border-radius: 1vh;
			background-color: rgba(255, 255, 255, 0.25);
		}
		#announcements-card {
			height: 90vh;
			width: 61vw;
			top: 9vh;
			left: 38vw;
		}
		.announcement-item {
		    height: 90vh;
		    width: 61vw;
			color: black;
		}
		.announcement-item-part {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		.announcement-item-text {
			background-color: rgba(255, 255, 255, 0.5);
			border-radius: 1vh;
			margin: .5vh .5vw .5vh .5vw;
		}
		.announcement-item-title {
			height: 10vh;
		}
		.announcement-item-body {
			height: 50vh;
			top: 10vh;
		}
		.announcement-item-img-div {
			height: 28.5vh;
			margin: .5vh .5vw .5vh .5vw;
		}
		.announcement-item-img {
			border-radius: 1vh;
			max-height: 100%;
			max-width: 100%;
		}
		#info-card {
			width: 36vw;
			top: 9vh;
			left: 1vw;
		}
		.section {
			color: white;
			position: absolute;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		#month-section {
			height: 10vh;
			width: 10vw;
			background-color: #e53935;
			border-top-left-radius: 1vh;
			padding: .5vh .5vw 0vh .5vw;
		}
		#date-section {
			height: 18vh;
			width: 10vw;
			top: 10vh;
			background-color: #e53935;
			border-bottom-left-radius: 1vh;
			padding: 0vh .5vw .5vh .5vw;
		}
		#time-section {
			height: 18vh;
			width: 20vw;
			left: 10vw;
			background-color: #ff1744;
			padding: .5vh .5vw 0vh .5vw;
		}
		#ampm-section {
			height: 10vh;
			width: 20vw;
			top: 18vh;
			left: 10vw;
			background-color: #ff1744;
			padding: 0vh .5vw 0.5vh .5vw;
		}
		#letter-day-section {
			height: 9vh;
			width: 6vw;
			left: 30vw;
			background-color: #1e90ff;
			border-top-right-radius: 1vh;
			padding: .5vh .5vw 0vh .5vw;
		}
		#period-section {
			height: 10vh;
			width: 6vw;
			left: 30vw;
			top: 9vh;
			background-color: #1e90ff;
			padding: 0vh .5vw 0vh .5vw;
		}
		#cycle-section {
			height: 9vh;
			width: 6vw;
			left: 30vw;
			top: 19vh;
			background-color: #1e90ff;
			border-bottom-right-radius: 1vh;
			padding: 0vh .5vw .5vh .5vw;
		}
		#slideshow-card {
			height: 61vh;
			width: 36vw;
			top: 38vh;
			left: 1vw;
		}
		.slideshow-div {
			height: 61vh;
			width: 36vw;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: .5vh .5vw .5vh .5vw;
		}
		.slideshow-img {
			border-radius: 1vh;
			max-height: 100%;
			max-width: 100%;
		}
	</style>
</head>

<body>
	<div id="ribbon">
		<img id="logo" src="images\logo.png">
	</div>
	<div id="announcements-card" class="card carousel slide" data-ride="carousel" data-interval="5000">
		<div id="annoucement-carousel-item-container" class="carousel-inner" role="listbox"></div>
	</div>
	<div id="info-card" class="card">
		<div id="month-section" class="section">
			<span>---</span>
		</div>
		<div id="date-section" class="section">
			<span>--</span>
		</div>
		<div id="time-section" class="section">
			<span>--:--</span>
		</div>
		<div id="ampm-section" class="section">
			<span>--</span>
		</div>
		<div id="letter-day-section" class="section">
			<span>-</span>
		</div>
		<div id="period-section" class="section">
			<span>--</span>
		</div>
		<div id="cycle-section" class="section">
			<span>-</span>
		</div>
	</div>
	<div id="slideshow-card" class="card carousel slide" data-ride="carousel" data-interval="3000">
		<div id="media-carousel-item-container" class="carousel-inner" role="listbox">
			<div class="item active">
				<div class="slideshow-div">
					<img class="slideshow-img" src="images\slideshow-images\1.jpg"/>
				</div>
			</div>
			<div class="item">
				<div class="slideshow-div">
					<img class="slideshow-img" src="images\slideshow-images\2.jpg"/>
				</div>
			</div>
			<div class="item">
				<div class="slideshow-div">
					<img class="slideshow-img" src="images\slideshow-images\3.jpg"/>
				</div>
			</div>
		</div>
	</div>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/jquery.textfill.js"></script>

<script type="text/javascript">
	function resizeElements() {
		$('#month-section').textfill({
			maxFontPixels: 200
		});
		$('#date-section').textfill({
			maxFontPixels: 200
		});
		$('#time-section').textfill({
			maxFontPixels: 200
		});
		$('#ampm-section').textfill({
			maxFontPixels: 200
		});
		$('#letter-day-section').textfill({
			maxFontPixels: 200
		});
		$('#period-section').textfill({
			maxFontPixels: 200
		});
		$('#cycle-section').textfill({
			maxFontPixels: 200
		});
		$('.announcement-item-title').textfill({
			maxFontPixels: 200
		});
		$('.announcement-item-body').textfill({
			maxFontPixels: 200
		});
	}

	function updateClock() {
		var now = new Date();
		var hour = now.getHours();
		var minute = now.getMinutes();
		var ampm = 'AM';
		var period = 'X';
		switch(hour) {
			case 7:
				period = 'HR';
				break;
			case 8:
				if (minute >= 38) {
					period = 'P2';
				} else {
					period = 'P1';
				}
				break;
			case 9:
				if (minute >=  20) {
					period = 'P3';
				} else {
					period = 'P2';
				}
			case 10:
				if (minute >= 44) {
					period = 'P5';
				} else if (minute >= 2) {
					period = 'P4';
				} else {
					period = 'P3';
				}
				break;
			case 11:
				if (minute >= 26) {
					period = 'P6';
				} else {
					period = 'P5';
				}
				break;
			case 12:
				if (minute >= 50) {
					period = 'P8';
				} else if (minute >= 8) {
					period = 'P7';
				} else {
					period = 'P6';
				}
				break;
			case 13:
				if (minute >= 32) {
					period = 'P9';
				} else {
					period = 'P8';
				}
				break;
			case 14:
				if (minute >= 45) {
					period = 'AS';
				} else {
					period = 'AP';
				}
				break;
			default:
				period = 'AS';
		}
		if (hour == 0) {
			hour = 12;
		} else if (hour == 12) {
			ampm = 'PM'
		} else if (hour > 12) {
			hour -= 12;
			ampm = 'PM';
		}
		if (minute < 10) {
			minute = '0' + minute;
		}
		$('#time-section').html('<span>' + hour + ':' + minute + '</span>');
		$('#ampm-section').html('<span>' + ampm + '</span>')
		var months = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
		$('#month-section').html('<span>' + months[now.getMonth()] + '</span>');
		$('#date-section').html('<span>' + now.getDate() + '</span>');
		$('#period-section').html('<span>' + period + '</span>');
		resizeElements();
		setTimeout(updateClock, 5000);
	}

	window.addEventListener('resize', resizeElements);
	updateClock();
	$('#announcements-card, #slideshow-card').carousel();
	$('#announcements-card').on('slid.bs.carousel', function() {
	    resizeElements();
	});
</script>

<script type="text/javascript">
	//client secret = dL5r3yMMjmeHxKNPHAjHbu9f
	var CLIENT_ID = '835795750372-1hej792ghu2omccu5061a2nsrtrjuhh2.apps.googleusercontent.com';
	var API_KEY = 'AIzaSyBt5O0GLMXaSYKphWXikYa9CQ2HcdiKhjw';
	var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
	var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

	function handleClientLoad() {
		gapi.load('client:auth2', initClient);
	}

	function initClient() {
		gapi.client.init({
			apiKey: API_KEY,
			clientId: CLIENT_ID,
			discoveryDocs: DISCOVERY_DOCS,
			scope: SCOPES
		}).then(function() {
			pullSheetData();
		});
	}

	function pullSheetData() {
		pullLetterDay();
		pullAnnouncements();
	}

	var letterDayCell = 'Calendar!A1'

	function pullLetterDay() { //refresh on new day
		gapi.client.sheets.spreadsheets.values.get({
			spreadsheetId: '1ovki_EYdu7FC2OZKbxBvnwiKHkePdcamvjXzuXIw4NA',
			range: letterDayCell,
		}).then(function(response) {
			var data = response.result.values;
			$('#letter-day-section').html('<span>' + data[0][0] + '</span>');
			resizeElements();
		});
	}

	var announcementDataRange = 'Approved Announcements!C:E'
	var announcementColumn = 0;
	var titleColumn = 1;
	var imageURLColumn = 2;

	function pullAnnouncements() { //refresh every so often
		gapi.client.sheets.spreadsheets.values.get({
			spreadsheetId: '1ovki_EYdu7FC2OZKbxBvnwiKHkePdcamvjXzuXIw4NA',
			range: announcementDataRange,
		}).then(function(response) {
			var data = response.result.values;
			for (var i = 1; i < data.length; i++) {
				var element = '';
				if (i == 1) {
					element = '<div class="item announcement-item active">';
				} else {
					element = '<div class="item announcement-item">';
				}
				if (!data[i][imageURLColumn]) {
					data[i][imageURLColumn] = 'images\\default-announcement-image.png';
				}
				element += '<div class="announcement-item-text"><div class="announcement-item-part announcement-item-title"><span>' + data[i][titleColumn] + '</span></div>';
				element += '<div class="announcement-item-part announcement-item-body"><span>' + data[i][announcementColumn] + '</span></div></div>';
				element += '<div class="announcement-item-part announcement-item-img-div"><img class="announcement-item-img" src="' + data[i][imageURLColumn] + '"/></div>';
				element += '</div>';
				$('#annoucement-carousel-item-container').append(element);
			}
			resizeElements();
		});
	}
</script>

<script
	async defer src="https://apis.google.com/js/api.js"
	onload="this.onload=function(){};handleClientLoad()"
	onreadystatechange="if (this.readyState === 'complete') this.onload()"></script>